{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["App","props","connect","a","web3","eth","getAccounts","accounts","account","setState","connected","fetchBalance","fetchMinterAccount","onReceiverChange","e","address","target","value","receiverAddress","onTransferAmountChange","amount","transferAmount","onMintReceiverChange","mintReceiverAddress","onMintAmountChange","mintAmount","onMint","contract","methods","mint","state","send","from","on","hash","txHash","status","action","receipt","onTransfer","minterAccount","ethBalance","balance","this","initWeb3","initContract","Web3","window","ethereum","Contract","abi","balances","call","getBalance","console","log","utils","fromWei","minter","className","onClick","isMinter","React","Component","DAppInfo","type","onChange","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.39aa16df.chunk.js","sourcesContent":["import React from 'react';\nimport Web3 from 'web3'\nimport './App.css';\nimport abi from './abi.json';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      connected: false, // 是否连接meta mask\n      account: '', // meta mask的以太坊账户\n      minterAccount: '', // 铸币者的以太坊账户\n      mintReceiverAddress: '', // 铸币的接收地址\n      mintAmount: '', // 铸币数量\n      ethBalance: 0, // 以太坊余额\n      balance: 0, // 币余额\n      txHash: '', // 广播的交易id\n      status: '', // 交易状态\n    }\n  }\n  componentDidMount() {\n    this.initWeb3();\n    this.initContract();\n  }\n\n  /**\n   * 初始化web3\n   */\n  initWeb3 () {\n    this.web3 = new Web3(window.ethereum);\n  }\n\n  /**\n   * 初始化合约\n   */\n  initContract () {\n    const contractAddress = '0xfa95506583310999dc823f45CaeD5faE3c2ED1b9';\n    const contract = new this.web3.eth.Contract(abi, contractAddress);\n    this.contract = contract;\n  }\n\n  /**\n   * 请求余额\n   */\n  async fetchBalance (account) {\n    const balance = await this.contract.methods.balances(account).call();\n    const ethBalance = await this.web3.eth.getBalance(account);\n    console.log('ethBalance', ethBalance)\n    this.setState({\n      balance,\n      ethBalance: Web3.utils.fromWei(ethBalance)\n    })\n  }\n\n  /**\n   * 请求铸币者地址\n   */\n  async fetchMinterAccount () {\n    const minterAccount = await this.contract.methods.minter().call();\n    this.setState({\n      minterAccount,\n    })\n  }\n  /**\n   * 连接Meta Mask的以太坊账户\n   * @returns {Promise<void>}\n   */\n  connect  = async () => {\n    const accounts = await this.web3.eth.getAccounts();\n    const account = accounts[0];\n    this.setState({\n      connected: true,\n      account: account\n    });\n    this.fetchBalance(account);\n    this.fetchMinterAccount();\n  }\n  /**\n   * 记录收款地址\n   * @param e\n   */\n  onReceiverChange = (e) =>{\n    const address = e.target.value;\n    this.setState({\n      receiverAddress: address\n    })\n  }\n  /**\n   * 记录转出数量\n   * @param e\n   */\n  onTransferAmountChange = (e) => {\n    const amount = e.target.value;\n    this.setState({\n      transferAmount: amount\n    })\n  }\n  /**\n   * 记录铸币数量\n   * @param e\n   */\n  onTransferAmountChange = (e) => {\n    const amount = e.target.value;\n    this.setState({\n      transferAmount: amount\n    })\n  }\n  /**\n   * 记录铸币的接收地址\n   * @param e\n   */\n  onMintReceiverChange = (e) =>{\n    const address = e.target.value;\n    this.setState({\n      mintReceiverAddress: address\n    })\n  }\n  /**\n   * 记录铸币数量\n   * @param e\n   */\n  onMintAmountChange = (e) => {\n    const amount = e.target.value;\n    this.setState({\n      mintAmount: amount\n    })\n  }\n  /**\n   * 铸币\n   */\n  onMint = () => {\n    // 在此调用合约方法mint\n    this.contract.methods.mint(this.state.mintReceiverAddress, this.state.mintAmount)\n      .send({\n        from: this.state.account\n      })\n      .on('transactionHash', (hash) => {\n        // 交易广播到节点，等待打包\n        this.setState({\n          txHash: hash,\n          status: 'pending',\n          action: '铸币',\n        });\n      })\n      .on('receipt', (receipt) => {\n        // 交易已被确认\n        this.setState({\n          status: 'confirmed',\n        });\n        // 刷新余额信息\n        this.fetchBalance(this.state.account);\n      });\n  }\n  /**\n   * 转账\n   */\n  onTransfer = () => {\n    // 在此调用合约方法send\n    this.contract.methods.send(this.state.receiverAddress, this.state.transferAmount)\n      .send({\n        from: this.state.account\n      })\n      .on('transactionHash', (hash) => {\n        // 交易广播到节点，等待打包\n        this.setState({\n          txHash: hash,\n          status: 'pending',\n          action: '转账',\n        });\n      })\n      .on('receipt', (receipt) => {\n        // 交易已被确认\n        this.setState({\n          status: 'confirmed',\n        });\n      });\n  }\n  render() {\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          DApp Coin\n        </header>\n        {\n          !this.state.connected && <button onClick={this.connect} className={'connectBtn'}>Connect MetaMask</button>\n        }\n        {\n          this.state.connected && <DAppInfo\n            onTransfer={this.onTransfer}\n            onReceiverChange={this.onReceiverChange}\n            onTransferAmountChange={this.onTransferAmountChange}\n            onMint={this.onMint}\n            onMintReceiverChange={this.onMintReceiverChange}\n            onMintAmountChange={this.onMintAmountChange}\n            ethBalance={this.state.ethBalance}\n            balance={this.state.balance}\n            account={this.state.account}\n            action={this.state.action}\n            txHash={this.state.txHash}\n            status={this.state.status}\n            isMinter={this.state.minterAccount === this.state.account}\n          />\n        }\n      </div>\n    );\n  }\n}\n\nexport default App;\n\n\nclass DAppInfo extends React.Component {\n  render() {\n    return <div className={'infoContainer'}>\n      <div className={'infoItem'}>\n        <label>账户地址：</label>\n        <span>\n          {\n            this.props.account\n          }\n        </span>\n      </div>\n      <div className={'infoItem'}>\n        <label>ETH余额：</label>\n        <span>\n          {\n            this.props.ethBalance\n          }\n        </span>\n      </div>\n      <div className={'infoItem'}>\n        <label>Coin余额：</label>\n        <span>\n          {\n            this.props.balance\n          }\n        </span>\n      </div>\n      {\n        this.props.isMinter &&  <div className={'transferCon'}>\n          <h2>铸币</h2>\n          <div className={'transferItem'}>\n            <label>收币地址：</label>\n            <input type='text' onChange={this.props.onMintReceiverChange}/>\n          </div>\n          <div className={'transferItem'}>\n            <label>铸币数量：</label>\n            <input type='number' onChange={this.props.onMintAmountChange}/>\n          </div>\n          <button onClick={this.props.onMint}>确定铸币</button>\n        </div>\n      }\n      <div className={'transferCon'}>\n        <h2>转账</h2>\n        <div className={'transferItem'}>\n          <label>收款地址：</label>\n          <input type='text' onChange={this.props.onReceiverChange}/>\n        </div>\n        <div className={'transferItem'}>\n          <label>转出数额：</label>\n          <input type='number' onChange={this.props.onTransferAmountChange}/>\n        </div>\n        <button onClick={this.props.onTransfer}>确定转出</button>\n      </div>\n      {\n        this.props.txHash && <div>\n          <h2>记录</h2>\n          <div>\n            <label>交易动作：</label>\n            <span>\n            {\n              this.props.action\n            }\n          </span>\n          </div>\n          <div>\n            <label>交易哈希：</label>\n            <span>\n            {\n              this.props.txHash\n            }\n          </span>\n          </div>\n          <div>\n            <label>交易状态：</label>\n            <span>\n            {\n              this.props.status\n            }\n          </span>\n          </div>\n        </div>\n      }\n    </div>\n  }\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}